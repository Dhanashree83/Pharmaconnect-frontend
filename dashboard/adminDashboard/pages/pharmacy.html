<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/dashboard/adminDashboard/styles/pharmacy.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <nav class="flex justify-between items-center bg-blue-600 text-white px-6 py-4">
        <!-- Logo -->
        <div class="text-xl font-bold">PharmaConnect</div>
      </nav>


      <div class="sidebar-container">
        <!-- Sidebar -->
        <div class="sidebar">
          <a href="#"><i class="bi bi-calendar-check"></i>Appointments</a>
          <a href="/dashboard/adminDashboard/pages/allUser.html"><i class="bi bi-person"></i>All Users</a>
          <a href="/dashboard/adminDashboard/pages/uploadMedicine.html"><i class="bi bi-person-badge"></i>Upload Medicine</a>
          <a href="/dashboard/adDashboard/pages/pharmacy.html"><i class="bi bi-capsule"></i>Pharmacy</a>
          <a href="/dashboard/adminDashboard/pages/hospital.html"><i class="bi bi-hospital"></i>Hospital</a>
          <a href="/dashboard/adminDashboard/pages/addDoctor.html"><i class="bi bi-plus-circle"></i>Add Doctor</a>
        </div>

        <div class="dashboard-container">
          <!-- Sidebar would go here -->
          
          <div class="main-content">
              <div class="page-header">
                  <h1 class="page-title">Pharmacy Management</h1>
                <a href="/dashboard/adminDashboard/pages/uploadMedicine.html">  <button class="btn btn-primary">Add New Medication</button></a>
              </div>
              
              <div class="pharmacy-container">
                  <div class="search-filter-bar">
                      <div class="search-box">
                          <span class="search-icon">üîç</span>
                          <input type="text" placeholder="Search medications...">
                      </div>
                      <div class="filter-dropdown">
                          <select>
                              <option>All Categories</option>
                              <option>Antibiotics</option>
                              <option>Analgesics</option>
                              <option>Antihistamines</option>
                              <option>Antidepressants</option>
                              <option>Vitamins</option>
                          </select>
                      </div>
                  </div>
                  
                  <div class="medication-list">
                      <!-- Medication Card 1 -->
                      <div class="medication-card">
                          <div class="medication-header">
                              <div>
                                  <div class="med-name">Amoxicillin</div>
                                  <span class="med-category">Antibiotic</span>
                              </div>
                              <div class="med-price">$12.99</div>
                          </div>
                          <div class="med-details">
                              500mg capsules. Used to treat bacterial infections including chest infections and dental abscesses.
                          </div>
                          <div class="med-stock">
                              <div class="stock-info in-stock">In Stock: 124</div>
                              <div class="stock-info">SKU: AMX-500-100</div>
                          </div>
                          <div class="action-buttons">
                              <button class="btn btn-primary">Prescribe</button>
                              <button class="btn btn-outline">Details</button>
                          </div>
                      </div>
                      
                      <!-- Medication Card 2 -->
                      <div class="medication-card">
                          <div class="medication-header">
                              <div>
                                  <div class="med-name">Ibuprofen</div>
                                  <span class="med-category">Analgesic</span>
                              </div>
                              <div class="med-price">$5.49</div>
                          </div>
                          <div class="med-details">
                              200mg tablets. Used for pain relief, reducing inflammation, and bringing down a high temperature.
                          </div>
                          <div class="med-stock">
                              <div class="stock-info low-stock">Low Stock: 8</div>
                              <div class="stock-info">SKU: IBP-200-50</div>
                          </div>
                          <div class="action-buttons">
                              <button class="btn btn-primary">Prescribe</button>
                              <button class="btn btn-outline">Details</button>
                          </div>
                      </div>
                      
                      <!-- Medication Card 3 -->
                      <div class="medication-card">
                          <div class="medication-header">
                              <div>
                                  <div class="med-name">Loratadine</div>
                                  <span class="med-category">Antihistamine</span>
                              </div>
                              <div class="med-price">$8.75</div>
                          </div>
                          <div class="med-details">
                              10mg tablets. Used to treat allergies such as hay fever, hives, conjunctivitis, and reactions to insect bites.
                          </div>
                          <div class="med-stock">
                              <div class="stock-info out-of-stock">Out of Stock</div>
                              <div class="stock-info">SKU: LOR-10-30</div>
                          </div>
                          <div class="action-buttons">
                              <button class="btn btn-primary" disabled>Prescribe</button>
                              <button class="btn btn-outline">Details</button>
                          </div>
                      </div>
                      
                      <!-- Medication Card 4 -->
                      <div class="medication-card">
                          <div class="medication-header">
                              <div>
                                  <div class="med-name">Vitamin D3</div>
                                  <span class="med-category">Vitamin</span>
                              </div>
                              <div class="med-price">$9.99</div>
                          </div>
                          <div class="med-details">
                              1000 IU softgels. Helps regulate the amount of calcium and phosphate in the body to keep bones, teeth and muscles healthy.
                          </div>
                          <div class="med-stock">
                              <div class="stock-info in-stock">In Stock: 42</div>
                              <div class="stock-info">SKU: VIT-D3-100</div>
                          </div>
                          <div class="action-buttons">
                              <button class="btn btn-primary">Prescribe</button>
                              <button class="btn btn-outline">Details</button>
                          </div>
                      </div>
                  </div>
                  
                  <div class="pagination">
                      <div class="page-item">¬´</div>
                      <div class="page-item active">1</div>
                      <div class="page-item">2</div>
                      <div class="page-item">3</div>
                      <div class="page-item">...</div>
                      <div class="page-item">8</div>
                      <div class="page-item">¬ª</div>
                  </div>
              </div>
          </div>
      </div>

      <div id="loader" class="fixed inset-0 bg-white flex items-center justify-center z-50 hidden">
        <div class="loader"></div>
      </div>

      

      <script>
        document.addEventListener('DOMContentLoaded', function () {
          fetchMedicines();
        });
      
        async function fetchMedicines() {
          const loader = document.getElementById('loader');
          const medicationList = document.querySelector('.medication-list');
          try {
            // Show loader
            loader.classList.remove('hidden');
            
            // 1. Call the API
            const response = await fetch('http://localhost:8082/api/medicine/available'); // <-- Your real API
            const medicines = await response.json();
            
            // 2. Clear previous medicines
            medicationList.innerHTML = '';
      
            // 3. Loop and create cards
            medicines.forEach(med => {
              const card = document.createElement('div');
              card.className = 'medication-card';
              card.innerHTML = `
                <div class="medication-header">
                  <div>
                    <div class="med-name">${med.name}</div>
                    <span class="med-category">${med.category}</span>
                  </div>
                  <div class="med-price">$${med.price.toFixed(2)}</div>
                </div>
                <div class="med-details">
                  ${med.description}
                </div>
                <div class="med-stock">
                  <div class="stock-info ${getStockClass(med.stock)}">
                    ${getStockText(med.stock)}
                  </div>
                  <div class="stock-info">SKU: ${med.sku}</div>
                </div>
                <div class="action-buttons">
                  <button class="btn btn-primary" ${med.stock <= 0 ? 'disabled' : ''}>Prescribe</button>
                  <button class="btn btn-outline">Details</button>
                </div>
              `;
              medicationList.appendChild(card);
            });
      
          } catch (error) {
            console.error('Failed to fetch medicines', error);
          } finally {
            // Hide loader
            loader.classList.add('hidden');
          }
        }
      
        function getStockClass(stock) {
          if (stock <= 0) return 'out-of-stock';
          if (stock < 10) return 'low-stock';
          return 'in-stock';
        }
      
        function getStockText(stock) {
          if (stock <= 0) return 'Out of Stock';
          if (stock < 10) return `Low Stock: ${stock}`;
          return `In Stock: ${stock}`;
        }
      </script>
      
</body>
</html>